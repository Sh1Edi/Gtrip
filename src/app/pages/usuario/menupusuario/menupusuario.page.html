<ion-header [translucent]="true">
  <ion-toolbar color="blue">
    <ion-title class="ion-text-center">
      <img src="assets/icon/g-trip-white.png" alt="Sin imagen" width="60px">
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" color="white" class="ion-content-text">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">mapa</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-card>
    <ion-item color="blue">
      <ion-icon name="location"></ion-icon>
      <span>{{cityName}}</span>
    <!-- <ion-item color="blue" lines="none">
      <p>Today's Report</p>
      <ion-label slot="end">{{todayDate | date: "EEE dd MMM"}}</ion-label>
    </ion-item> -->
    <span>:</span>
        <span>
          {{(weatherTemp?.temp - 273.15).toFixed(0)}}
        </span>
        <span>°C</span>
        <img slot="end" [src]=weatherIcon>
      </ion-item>
    </ion-card>

  
    <!-- <ion-item>
      <span>Maximum Temp</span>
      <span slot="end">{{(weatherTemp?.temp_max - 273.15).toFixed(0)}}</span>
    </ion-item>
    <ion-item>
      <span>Minimun Temp</span>
      <span slot="end">{{(weatherTemp?.temp_min - 273.15).toFixed(0)}}</span>
    </ion-item> -->
    <!-- <ion-item>
      <span>Humidity</span>
      <span slot="end">{{weatherTemp?.humidity}} %</span>
    </ion-item> -->
  
  <ion-grid>
    <ion-row> <!-- Fila 1 Inicio -->
      <ion-col>
        <!-- Carta del buscador de ubicación -->
        <ion-card color="gray">
          <ion-card-header color="gray">
            <ion-card-title>Bienvenido {{ usuario?.nombreusuario }} {{ usuario?.apellidousuario }}</ion-card-title>
            <ion-card-subtitle >Selecciona tu comuna para buscar un recorrido</ion-card-subtitle>
          </ion-card-header>

    
            <ion-card-content color="gray" >
              <ion-item fill="outline">
                <ion-select [(ngModel)]="eleccionComuna" label="Selecciona tu comuna" color="gray">
                  <ion-select-option *ngFor="let x of arregloComunas" [value]="x">{{x.nombrecomuna}}</ion-select-option>
                </ion-select>
              </ion-item>
            </ion-card-content>
      

          <div class="ion-text-center">
            <ion-button type="submit" fill="solid" color="blue" (click)="filtrarViajes()">Ver viajes
              Disponibles</ion-button>

            <!--*ngIf="idrol == 3"-->
            <ion-button *ngIf="rol == 3"    style="font-size: 12px; width: 120px; " fill="solid" color="blue" (click)="viaje()">Crear viaje</ion-button>
          </div>
        </ion-card>
      </ion-col>
    </ion-row> <!-- Fila 1 Final -->

  </ion-grid>

  <!-- Mostrar los viajes filtrados -->
  <div *ngIf="Viajes" color="gray">
    <div *ngFor="let viaje of Viajes | async" class="viaje-container">
      <ion-card color="gray" *ngIf="viaje.asientos > 0">
        <ion-item color="gray">
          <ion-avatar slot="start" class="imagen" color="gray">
            <img alt="Sin imagen" [src]="viaje.conductor.fotousuario"/>
          </ion-avatar>
          <ion-item color="gray">
            <ion-label>Conductor: {{ viaje.conductor.nombreusuario }} {{ viaje.conductor.apellidousuario }}</ion-label>
          </ion-item>
        </ion-item>
        <ion-item class="informacion" color="gray">
          <ion-label>Descripcion: {{ viaje.descripcion}}</ion-label>
        </ion-item>
        <ion-item class="informacion" color="gray">
          <ion-label>Ubicación Actual: {{ viaje.sede.nombresede }}</ion-label>
        </ion-item>
        <ion-item class="informacion" color="gray">
          <ion-label>Llega hasta: {{ viaje.comuna.nombrecomuna }}</ion-label>
        </ion-item>
        <ion-item class="informacion" color="gray">
          <ion-label>Asientos libres: {{ viaje.asientos }}</ion-label>
          <ion-label>Valor: ${{ viaje.valor }}</ion-label>
        </ion-item>
        <ion-item class="informacion" color="gray">
          <ion-label>Hora de salida: {{ viaje.hora }}</ion-label>
        </ion-item>

        <ion-button *ngIf="viaje.asientos > 0 && !viaje.tomado && rol == 2"  (click)="tomarViaje(viaje)"
          [disabled]="disabledButton1">Tomar viaje</ion-button>

        <ion-button (click)="cancelarViaje(viaje)" [disabled]="disabledButton2" *ngIf="rol == 2">Cancelar Viaje</ion-button>

      </ion-card>
    </div>
  </div>

  <!-- Final del contenido -->
</ion-content>
<ion-footer>
  <ion-tab-bar slot="bottom" color="blue">
    <ion-tab-button tab="home" class="menu" (click)="irMenu()">
      <ion-icon name="home-outline" style="color: white;"></ion-icon>
      Inicio
    </ion-tab-button>
    <ion-tab-button tab="radio" (click)="irPerfil()">
      <ion-icon name="person-outline"></ion-icon>
      Perfil
    </ion-tab-button>
    <ion-tab-button tab="search" (click)="irAjustes()">
      <ion-icon name="settings-outline"></ion-icon>
      Ajustes
    </ion-tab-button>
    <ion-tab-button tab="search" (click)="ubicacion()">
      <ion-icon name="locate-outline"></ion-icon>
      Ubicacion
    </ion-tab-button> 
  </ion-tab-bar>
</ion-footer>